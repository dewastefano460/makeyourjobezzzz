<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Daily Task Helper - All in One</title>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tweetnacl/1.0.3/nacl.min.js"></script>

    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['"Plus Jakarta Sans"', 'sans-serif'],
                        mono: ['"JetBrains Mono"', 'monospace'],
                    },
                    colors: {
                        sidebar: '#0f172a', 
                        active: '#3b82f6', 
                    }
                }
            }
        }
    </script>
	<style>
			/* Custom Scrollbar */
			::-webkit-scrollbar { width: 6px; height: 6px; }
			::-webkit-scrollbar-track { background: transparent; }
			::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }
			::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

			/* --- LOGIKA ANIMASI PAGE --- */
			
			/* 1. Sembunyikan view secara default */
			.section-view { 
				display: none; 
			}

			/* 2. Definisi Keyframe Animasi (Muncul dari bawah + Fade In) */
			@keyframes fadeInUp {
				0% {
					opacity: 0;
					transform: translateY(20px) scale(0.98); /* Turun dikit & agak kecil */
					filter: blur(2px); /* Efek blur dikit biar modern */
				}
				100% {
					opacity: 1;
					transform: translateY(0) scale(1); /* Posisi normal */
					filter: blur(0);
				}
			}

			/* 3. Saat view aktif, jalankan animasi */
			.section-view.active { 
				display: block; 
				animation: fadeInUp 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards; 
			}

			/* --- BONUS: ANIMASI KARTU DASHBOARD (STAGGERED) --- */
			/* Biar kartu di dashboard munculnya gantian satu-satu */
			
			#view-dashboard.active .card-shortcut {
				opacity: 0;
				animation: fadeInUp 0.5s cubic-bezier(0.16, 1, 0.3, 1) forwards;
			}

			/* Delay untuk setiap kartu */
			#view-dashboard.active .card-shortcut:nth-child(1) { animation-delay: 0.1s; }
			#view-dashboard.active .card-shortcut:nth-child(2) { animation-delay: 0.2s; }
			#view-dashboard.active .card-shortcut:nth-child(3) { animation-delay: 0.3s; }
			#view-dashboard.active .card-shortcut:nth-child(4) { animation-delay: 0.4s; }

		</style>
</head>
<body class="bg-slate-50 text-slate-800 font-sans h-screen flex overflow-hidden">

    <aside id="main-sidebar" class="w-64 bg-sidebar text-slate-300 flex-shrink-0 fixed inset-y-0 left-0 z-50 hidden md:relative md:flex flex-col shadow-2xl transition-all duration-300">
        <div class="h-16 flex items-center px-6 border-b border-slate-700/50">
            <div class="font-bold text-xl text-white tracking-wide">DAILY<span class="text-blue-500">DEWOK</span></div>
        </div>

        <div class="p-4 space-y-8 overflow-y-auto flex-1">
            <div>
                <div class="text-xs font-semibold text-slate-500 uppercase tracking-wider mb-3 px-2">Main Menu</div>
                <nav class="space-y-1">
                    <button onclick="switchView('dashboard')" class="nav-btn w-full flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-slate-800 hover:text-white transition-colors text-left text-sm font-medium active-nav" data-target="dashboard">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path></svg>
                        Dashboard
                    </button>
                </nav>
            </div>

            <div>
                <div class="text-xs font-semibold text-slate-500 uppercase tracking-wider mb-3 px-2">Instalasi / Provisioning</div>
                <nav class="space-y-1">
                    <button onclick="switchView('prime-pppoe')" class="nav-btn w-full flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-slate-800 hover:text-white transition-colors text-left text-sm font-medium" data-target="prime-pppoe">
                        <svg class="w-5 h-5 text-orange-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                        Prime PPPoE
                    </button>
                    <button onclick="switchView('prime-statik')" class="nav-btn w-full flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-slate-800 hover:text-white transition-colors text-left text-sm font-medium" data-target="prime-statik">
                        <svg class="w-5 h-5 text-orange-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"></path></svg>
                        Prime Statik
                    </button>
                    <button onclick="switchView('impressive-pppoe')" class="nav-btn w-full flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-slate-800 hover:text-white transition-colors text-left text-sm font-medium" data-target="impressive-pppoe">
                        <svg class="w-5 h-5 text-indigo-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path></svg>
                        Impressive PPPoE
                    </button>
                    <button onclick="switchView('bs-ippub')" class="nav-btn w-full flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-slate-800 hover:text-white transition-colors text-left text-sm font-medium" data-target="bs-ippub">
                        <svg class="w-5 h-5 text-cyan-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"></path></svg>
                        Bitstream IP Pub
                    </button>
                    <button onclick="switchView('bs-ippriv')" class="nav-btn w-full flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-slate-800 hover:text-white transition-colors text-left text-sm font-medium" data-target="bs-ippriv">
                        <svg class="w-5 h-5 text-cyan-400" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 11c0 3.517-1.009 6.799-2.753 9.571m-3.44-2.04l.054-.09A13.916 13.916 0 008 11a4 4 0 118 0c0 1.017-.07 2.019-.203 3m-2.118 6.844A21.88 21.88 0 0015.171 17m3.839 1.132c.645-2.266.99-4.659.99-7.132A8 8 0 008 4.07M3 15.364c.64-1.319 1-2.8 1-4.364 0-1.457.39-2.823 1.07-4"></path></svg>
                        Bitstream IP Priv
                    </button>
                </nav>
            </div>

            <div>
				<div class="text-xs font-semibold text-slate-500 uppercase tracking-wider mb-3 px-2">Maintenance</div>
				<nav class="space-y-1">
					<button onclick="switchView('cs-prime')" class="nav-btn w-full flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-slate-800 hover:text-white transition-colors text-left text-sm font-medium" data-target="cs-prime">
						<svg class="w-5 h-5 text-orange-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>
						GL - Prime
					</button>
					<button onclick="switchView('cs-imp')" class="nav-btn w-full flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-slate-800 hover:text-white transition-colors text-left text-sm font-medium" data-target="cs-imp">
						<svg class="w-5 h-5 text-indigo-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4"></path></svg>
						GL - Impressive
					</button>
				</nav>
			</div>

            <div>
                <div class="text-xs font-semibold text-slate-500 uppercase tracking-wider mb-3 px-2 text-red-400">Termination</div>
                <nav class="space-y-1">
                    <button onclick="switchView('terminate')" class="nav-btn w-full flex items-center gap-3 px-3 py-2 rounded-lg hover:bg-slate-800 hover:text-white transition-colors text-left text-sm font-medium text-red-300 hover:text-red-100" data-target="terminate">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                        Terminate Pelanggan
                    </button>
                </nav>
            </div>
        </div>
        
        <div class="p-4 border-t border-slate-700/50">
            <div class="text-xs text-slate-500 text-center">&copy; 2025 Daily Dewok</div>
        </div>
    </aside>

    <div class="md:hidden absolute top-0 w-full h-16 bg-sidebar z-30 flex items-center justify-between px-4 shadow-md">
        <div class="font-bold text-white">DAILY DEWOK</div>
        <button id="mobile-menu-btn" class="text-white p-2">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
        </button>
    </div>

    <main class="flex-1 overflow-x-hidden overflow-y-auto bg-slate-50 pt-16 md:pt-0 relative">
        
        <div id="view-dashboard" class="section-view active p-6 max-w-7xl mx-auto">
            <header class="mb-8">
                <h1 class="text-3xl font-bold text-slate-800">Kerja Boi</h1>
                <p class="text-slate-500">Ora ubet ora ngliwet. Makane kerjo boi.</p>
            </header>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                
                <div onclick="switchView('prime-pppoe')" class="card-shortcut bg-white border border-slate-200 hover:border-orange-300 hover:shadow-md group">
                    <div class="w-12 h-12 bg-orange-100 rounded-lg flex items-center justify-center text-orange-600 mb-3 group-hover:scale-110 transition-transform">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                    </div>
                    <h3 class="font-bold text-slate-700 group-hover:text-orange-600 transition-colors">Prime PPPoE</h3>
                    <p class="text-xs text-slate-400 mt-1">Layanan Fiber Utama</p>
                </div>

                <div onclick="switchView('impressive-pppoe')" class="card-shortcut bg-white border border-slate-200 hover:border-indigo-300 hover:shadow-md group">
                    <div class="w-12 h-12 bg-indigo-100 rounded-lg flex items-center justify-center text-indigo-600 mb-3 group-hover:scale-110 transition-transform">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19.428 15.428a2 2 0 00-1.022-.547l-2.384-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 10.172V5L8 4z"></path></svg>
                    </div>
                    <h3 class="font-bold text-slate-700 group-hover:text-indigo-600 transition-colors">Impressive</h3>
                    <p class="text-xs text-slate-400 mt-1">Layanan Second Line</p>
                </div>

                <div onclick="switchView('bs-ippub')" class="card-shortcut bg-white border border-slate-200 hover:border-cyan-300 hover:shadow-md group">
                    <div class="w-12 h-12 bg-cyan-100 rounded-lg flex items-center justify-center text-cyan-600 mb-3 group-hover:scale-110 transition-transform">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 12a9 9 0 01-9 9m9-9a9 9 0 00-9-9m9 9H3m9 9a9 9 0 01-9-9m9 9c1.657 0 3-4.03 3-9s-1.343-9-3-9m0 18c-1.657 0-3-4.03-3-9s1.343-9 3-9m-9 9a9 9 0 019-9"></path></svg>
                    </div>
                    <h3 class="font-bold text-slate-700 group-hover:text-cyan-600 transition-colors">Bitstream</h3>
                    <p class="text-xs text-slate-400 mt-1">Layanan Pihak Ketiga</p>
                </div>

                 <div onclick="switchView('terminate')" class="card-shortcut bg-white border border-slate-200 hover:border-red-300 hover:shadow-md group">
                    <div class="w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center text-red-600 mb-3 group-hover:scale-110 transition-transform">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                    </div>
                    <h3 class="font-bold text-slate-700 group-hover:text-red-600 transition-colors">Terminate</h3>
                    <p class="text-xs text-slate-400 mt-1">Hapus Pelanggan</p>
                </div>

            </div>
        </div>

        <div id="view-prime-pppoe" class="section-view p-6 max-w-6xl mx-auto">
            <h2 class="view-title text-orange-600">PRIME <span class="text-slate-700">PPPoE Provisioning</span></h2>
            <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 mb-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="space-y-4">
                        <div><label class="label-std">Nama Klien</label><input type="text" id="prm-nama" class="w-full input-field"></div>
                        <div><label class="label-std">Service ID</label><input type="text" id="prm-sid" class="w-full input-field"></div>
                        <div class="grid grid-cols-2 gap-4">
                            <div><label class="label-std">Layanan (Mbps)</label><input type="number" id="prm-bw" class="w-full input-field"></div>
                            <div><label class="label-std">User PPPoE</label><input type="text" id="prm-user" class="w-full input-field"></div>
                        </div>
                        <div>
                            <label class="label-std">Password</label>
                            <div class="flex gap-2"><input type="text" id="prm-pass" readonly class="w-full bg-slate-100 input-field"><button onclick="generatePassword('prm-pass')" class="btn-secondary">Gen</button></div>
                        </div>
                    </div>
                    <div class="space-y-4">
                        <div><label class="label-std">IP Address</label><input type="text" id="prm-ip" class="w-full input-field"></div>
                        <div class="grid grid-cols-2 gap-4">
                            <div><label class="label-std">SVLAN</label><input type="text" id="prm-svlan" class="w-full input-field"></div>
                            <div><label class="label-std">CVLAN</label><input type="text" id="prm-cvlan" class="w-full input-field"></div>
                        </div>
                        <div>
                            <label class="label-std">VLAN Name</label>
                            <div class="flex gap-2"><input type="text" id="prm-vlan-name" readonly class="w-full bg-slate-100 input-field"><button onclick="generateVlanName('prm-svlan', 'prm-cvlan', 'prm-vlan-name')" class="btn-secondary">Gen</button></div>
                        </div>
                        <div class="pt-5 flex gap-2 justify-end">
                            <button onclick="clearForm('prime')" class="text-red-500 text-sm font-medium hover:underline px-3">Clear</button>
                            <button onclick="processPrimePPPoE()" class="btn-primary bg-orange-600 hover:bg-orange-700">Convert Script</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="output-card"><div class="output-header bg-slate-800"><span>Output DR.KSP</span><button onclick="copyToClipboard('out-prm-1')" class="copy-btn">Copy</button></div><textarea id="out-prm-1" readonly class="output-area text-green-400"></textarea></div>
                <div class="output-card"><div class="output-header bg-slate-800"><span>Output DR.NCDC</span><button onclick="copyToClipboard('out-prm-2')" class="copy-btn">Copy</button></div><textarea id="out-prm-2" readonly class="output-area text-blue-400"></textarea></div>
            </div>
        </div>

        <div id="view-prime-statik" class="section-view p-6 max-w-6xl mx-auto">
             <h2 class="view-title text-orange-600">PRIME <span class="text-slate-700">Statik Provisioning</span></h2>
             <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 mb-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="space-y-4">
                        <div><label class="label-std">Nama Klien</label><input type="text" id="prm-st-nama" class="w-full input-field"></div>
                        <div><label class="label-std">Service ID</label><input type="text" id="prm-st-sid" class="w-full input-field"></div>
                        <div><label class="label-std">Layanan (Mbps)</label><input type="number" id="prm-st-bw" class="w-full input-field"></div>
                    </div>
                    <div class="space-y-4">
                        <div><label class="label-std">IP Address (CIDR)</label><input type="text" id="prm-st-ip" class="w-full input-field"></div>
                        <div class="grid grid-cols-2 gap-4">
                            <div><label class="label-std">SVLAN</label><input type="text" id="prm-st-svlan" class="w-full input-field"></div>
                            <div><label class="label-std">CVLAN</label><input type="text" id="prm-st-cvlan" class="w-full input-field"></div>
                        </div>
                         <div>
                            <label class="label-std">VLAN Name</label>
                            <div class="flex gap-2"><input type="text" id="prm-st-vlan-name" readonly class="w-full bg-slate-100 input-field"><button onclick="generateVlanName('prm-st-svlan', 'prm-st-cvlan', 'prm-st-vlan-name')" class="btn-secondary">Gen</button></div>
                        </div>
                        <div class="pt-5 flex gap-2 justify-end">
                            <button onclick="processPrimeStatik()" class="btn-primary bg-orange-600 hover:bg-orange-700">Convert Script</button>
                        </div>
                    </div>
                </div>
             </div>
             <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="output-card"><div class="output-header bg-slate-800"><span>Output DR.KSP</span><button onclick="copyToClipboard('out-prm-st-1')" class="copy-btn">Copy</button></div><textarea id="out-prm-st-1" readonly class="output-area text-green-400"></textarea></div>
                <div class="output-card"><div class="output-header bg-slate-800"><span>Output DR.NCDC</span><button onclick="copyToClipboard('out-prm-st-2')" class="copy-btn">Copy</button></div><textarea id="out-prm-st-2" readonly class="output-area text-blue-400"></textarea></div>
            </div>
        </div>

        <div id="view-impressive-pppoe" class="section-view p-6 max-w-6xl mx-auto">
            <h2 class="view-title text-indigo-600">IMPRESSIVE <span class="text-slate-700">PPPoE Provisioning</span></h2>
            <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 mb-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="space-y-4">
                        <div><label class="label-std">Nama Klien</label><input type="text" id="imp-nama" class="w-full input-field"></div>
                        <div><label class="label-std">Service ID</label><input type="text" id="imp-sid" class="w-full input-field"></div>
                        <div><label class="label-std">Password</label><div class="flex gap-2"><input type="text" id="imp-pass" readonly class="w-full bg-slate-100 input-field"><button onclick="generatePassword('imp-pass')" class="btn-secondary">Gen</button></div></div>
                        <div><label class="label-std">Layanan (Mbps)</label><input type="number" id="imp-bw" class="w-full input-field"></div>
                        <div><label class="label-std">User PPPoE</label><input type="text" id="imp-user" class="w-full input-field"></div>
                    </div>
                    <div class="space-y-4">
                        <div><label class="label-std">IP Address</label><input type="text" id="imp-ip" class="w-full input-field font-mono"></div>
                        <div class="grid grid-cols-2 gap-4">
                            <div><label class="label-std">SVLAN</label><input type="text" id="imp-svlan" class="w-full input-field"></div>
                            <div><label class="label-std">CVLAN</label><input type="text" id="imp-cvlan" class="w-full input-field"></div>
                        </div>
                        <div><label class="label-std">VLAN Name</label><div class="flex gap-2"><input type="text" id="imp-vlan-name" readonly class="w-full bg-slate-100 input-field"><button onclick="generateVlanName('imp-svlan', 'imp-cvlan', 'imp-vlan-name')" class="btn-secondary">Gen</button></div></div>
                        <div><label class="label-std">Parent Name</label><input type="text" id="imp-parent" class="w-full input-field"></div>
                        <div class="pt-5 flex gap-2 justify-end">
                            <button onclick="clearForm('impressive')" class="text-red-500 text-sm font-medium hover:underline px-3">Clear</button>
                            <button onclick="processImpressivePPPoE()" class="btn-primary bg-indigo-600 hover:bg-indigo-700">Convert Script</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="output-card"><div class="output-header bg-slate-800"><span>Output DR.KSP</span><button onclick="copyToClipboard('out-imp-1')" class="copy-btn">Copy</button></div><textarea id="out-imp-1" readonly class="output-area text-green-400"></textarea></div>
                <div class="output-card"><div class="output-header bg-slate-800"><span>Output DR.NCDC</span><button onclick="copyToClipboard('out-imp-2')" class="copy-btn">Copy</button></div><textarea id="out-imp-2" readonly class="output-area text-blue-400"></textarea></div>
            </div>
        </div>

        <div id="view-bs-ippub" class="section-view p-6 max-w-6xl mx-auto">
            <h2 class="view-title text-cyan-600">BITSTREAM <span class="text-slate-700">IP Public</span></h2>
            <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 mb-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="space-y-4">
                        <div><label class="label-std">Nama Klien</label><input type="text" id="bs-pub-nama" class="w-full input-field"></div>
                        <div><label class="label-std">Service ID</label><input type="text" id="bs-pub-sid" class="w-full input-field"></div>
                        <div><label class="label-std">Layanan (Mbps)</label><input type="number" id="bs-pub-bw" class="w-full input-field"></div>
                        <div>
                            <label class="label-std">WireGuard Keys</label>
                            <div class="flex gap-2 mb-2">
                                <input type="text" id="bs-pub-priv" readonly placeholder="Private Key" class="w-1/2 bg-slate-100 input-field text-xs">
                                <input type="text" id="bs-pub-pub" readonly placeholder="Public Key" class="w-1/2 bg-slate-100 input-field text-xs">
                            </div>
                            <button onclick="generateWgKeys('bs-pub-priv', 'bs-pub-pub')" class="btn-secondary w-full">Generate WG Keys</button>
                        </div>
                    </div>
                    <div class="space-y-4">
                        <div><label class="label-std">IP Publik</label><input type="text" id="bs-pub-ip" class="w-full input-field font-mono"></div>
                        <div><label class="label-std">Parent Name</label><input type="text" id="bs-pub-parent" class="w-full input-field"></div>
                        <div><label class="label-std">IP WAN ONU Telkom</label><input type="text" id="bs-pub-wan" class="w-full input-field font-mono"></div>
                        <div class="pt-5 flex gap-2 justify-end">
                             <button onclick="clearForm('bs-pub')" class="text-red-500 text-sm font-medium hover:underline px-3">Clear</button>
                             <button onclick="processBsIpPub()" class="btn-primary bg-cyan-600 hover:bg-cyan-700">Convert Script</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="output-card"><div class="output-header bg-slate-800"><span>Script Retail-v7</span><button onclick="copyToClipboard('out-bs-pub-1')" class="copy-btn">Copy</button></div><textarea id="out-bs-pub-1" readonly class="output-area text-green-400"></textarea></div>
                <div class="output-card"><div class="output-header bg-slate-800"><span>Script Klien (NCDC)</span><button onclick="copyToClipboard('out-bs-pub-2')" class="copy-btn">Copy</button></div><textarea id="out-bs-pub-2" readonly class="output-area text-blue-400"></textarea></div>
            </div>
        </div>

        <div id="view-bs-ippriv" class="section-view p-6 max-w-6xl mx-auto">
            <h2 class="view-title text-cyan-500">BITSTREAM <span class="text-slate-700">IP Private</span></h2>
            <div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 mb-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="space-y-4">
                        <div><label class="label-std">Nama Klien</label><input type="text" id="bs-priv-nama" class="w-full input-field"></div>
                        <div><label class="label-std">Service ID</label><input type="text" id="bs-priv-sid" class="w-full input-field"></div>
                        <div><label class="label-std">Layanan (Mbps)</label><input type="number" id="bs-priv-bw" class="w-full input-field"></div>
                        <div>
                            <label class="label-std">WireGuard Keys</label>
                            <div class="flex gap-2 mb-2">
                                <input type="text" id="bs-priv-priv" readonly placeholder="Private Key" class="w-1/2 bg-slate-100 input-field text-xs">
                                <input type="text" id="bs-priv-pub" readonly placeholder="Public Key" class="w-1/2 bg-slate-100 input-field text-xs">
                            </div>
                            <button onclick="generateWgKeys('bs-priv-priv', 'bs-priv-pub')" class="btn-secondary w-full">Generate WG Keys</button>
                        </div>
                    </div>
                    <div class="space-y-4">
                        <div><label class="label-std">IP Address Monitoring</label><input type="text" id="bs-priv-ip" class="w-full input-field font-mono"></div>
                        <div><label class="label-std">Parent Name</label><input type="text" id="bs-priv-parent" class="w-full input-field"></div>
                        <div><label class="label-std">IP WAN ONU Telkom</label><input type="text" id="bs-priv-wan" class="w-full input-field font-mono"></div>
                        <div class="pt-5 flex gap-2 justify-end">
                            <button onclick="clearForm('bs-priv')" class="text-red-500 text-sm font-medium hover:underline px-3">Clear</button>
                            <button onclick="processBsIpPriv()" class="btn-primary bg-cyan-600 hover:bg-cyan-700">Convert Script</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div class="output-card"><div class="output-header bg-slate-800"><span>Script Retail-v7</span><button onclick="copyToClipboard('out-bs-priv-1')" class="copy-btn">Copy</button></div><textarea id="out-bs-priv-1" readonly class="output-area text-green-400"></textarea></div>
                <div class="output-card"><div class="output-header bg-slate-800"><span>Script Klien (NCDC)</span><button onclick="copyToClipboard('out-bs-priv-2')" class="copy-btn">Copy</button></div><textarea id="out-bs-priv-2" readonly class="output-area text-blue-400"></textarea></div>
            </div>
        </div>
        
		<div id="view-cs-prime" class="section-view p-6 max-w-6xl mx-auto">
			<h2 class="view-title text-orange-600">MAINTENANCE <span class="text-slate-700">Prime</span></h2>
			<div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 mb-6">
				<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
					<div class="space-y-4">
						<div><label class="label-std">Nama Klien</label><input type="text" id="cs-prm-nama" class="w-full input-field"></div>
						<div><label class="label-std">Service ID</label><input type="text" id="cs-prm-sid" class="w-full input-field"></div>
					</div>
					<div class="space-y-4">
						<div><label class="label-std">Layanan Baru (Mbps)</label><input type="number" id="cs-prm-bw" class="w-full input-field" placeholder="Contoh: 50"></div>
						<div><label class="label-std">IP Address (Target)</label><input type="text" id="cs-prm-ip" class="w-full input-field font-mono" placeholder="IP / CIDR"></div>
						<div class="pt-5 flex gap-2 justify-end">
							<button onclick="clearForm('cs-prime')" class="text-red-500 text-sm font-medium hover:underline px-3">Clear</button>
							<button onclick="processCsPrime()" class="btn-primary bg-orange-600 hover:bg-orange-700">Convert Script</button>
						</div>
					</div>
				</div>
			</div>
			<div class="output-card h-64">
				<div class="output-header bg-slate-800"><span>Script Change Prime</span><button onclick="copyToClipboard('out-cs-prm')" class="copy-btn">Copy</button></div>
				<textarea id="out-cs-prm" readonly class="output-area text-green-400"></textarea>
			</div>
		</div>

		<div id="view-cs-imp" class="section-view p-6 max-w-6xl mx-auto">
			<h2 class="view-title text-indigo-600">MAINTENANCE <span class="text-slate-700">Impressive</span></h2>
			<div class="bg-white rounded-xl shadow-sm border border-slate-200 p-6 mb-6">
				<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
					<div class="space-y-4">
						<div><label class="label-std">Nama Klien</label><input type="text" id="cs-imp-nama" class="w-full input-field"></div>
						<div><label class="label-std">Service ID</label><input type="text" id="cs-imp-sid" class="w-full input-field"></div>
						<div><label class="label-std">Layanan Baru (Mbps)</label><input type="number" id="cs-imp-bw" class="w-full input-field"></div>
					</div>
					<div class="space-y-4">
						<div><label class="label-std">IP Address Lama</label><input type="text" id="cs-imp-old" class="w-full input-field font-mono"></div>
						<div><label class="label-std">IP Address Baru</label><input type="text" id="cs-imp-new" class="w-full input-field font-mono"></div>
						<div><label class="label-std">Parent Name</label><input type="text" id="cs-imp-parent" class="w-full input-field"></div>
						<div class="pt-5 flex gap-2 justify-end">
							<button onclick="clearForm('cs-imp')" class="text-red-500 text-sm font-medium hover:underline px-3">Clear</button>
							<button onclick="processCsImp()" class="btn-primary bg-indigo-600 hover:bg-indigo-700">Convert Script</button>
						</div>
					</div>
				</div>
			</div>
			<div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
				<div class="output-card">
					<div class="output-header bg-slate-800"><span>Script Change</span><button onclick="copyToClipboard('out-cs-imp-1')" class="copy-btn">Copy</button></div>
					<textarea id="out-cs-imp-1" readonly class="output-area text-green-400"></textarea>
				</div>
				<div class="output-card">
					<div class="output-header bg-slate-800"><span>Summary</span><button onclick="copyToClipboard('out-cs-imp-2')" class="copy-btn">Copy</button></div>
					<textarea id="out-cs-imp-2" readonly class="output-area text-blue-400"></textarea>
				</div>
			</div>
		</div>

        <div id="view-terminate" class="section-view p-6 max-w-6xl mx-auto">
            <h2 class="view-title text-red-600">TERMINATION <span class="text-slate-700">Hapus Pelanggan</span></h2>
            <div class="bg-white rounded-xl shadow-sm border border-red-100 p-6 mb-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div><label class="label-std">Nama Vlan</label><input type="text" id="term-nama" class="w-full input-field" placeholder="Nama Persis di Mikrotik"></div>
                    <div><label class="label-std">IP Address</label><input type="text" id="term-ip" class="w-full input-field" placeholder="IP Target Queue"></div>
                </div>
                <div class="pt-5 flex gap-2 justify-end">
                    <button onclick="clearForm('term')" class="text-red-500 text-sm font-medium hover:underline px-3">Clear</button>
                    <button onclick="processTerminate()" class="btn-primary bg-red-600 hover:bg-red-700 shadow-red-500/30">Convert Script</button>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div class="output-card h-48">
                    <div class="output-header bg-slate-800"><span>Output DR.KSP</span><button onclick="copyToClipboard('out-term-1')" class="copy-btn">Copy</button></div>
                    <textarea id="out-term-1" readonly class="output-area text-red-400"></textarea>
                </div>
                <div class="output-card h-48">
                    <div class="output-header bg-slate-800"><span>Output DR.FO1</span><button onclick="copyToClipboard('out-term-2')" class="copy-btn">Copy</button></div>
                    <textarea id="out-term-2" readonly class="output-area text-red-400"></textarea>
                </div>
                <div class="output-card h-48">
                    <div class="output-header bg-slate-800"><span>Output DR.FO2</span><button onclick="copyToClipboard('out-term-3')" class="copy-btn">Copy</button></div>
                    <textarea id="out-term-3" readonly class="output-area text-red-400"></textarea>
                </div>
            </div>
        </div>

    </main>

    <script>
        // --- STYLES HELPER ---
        document.querySelectorAll('.input-field').forEach(el => el.className += ' px-4 py-2 border border-slate-300 rounded-lg focus:ring-2 focus:ring-blue-200 focus:border-blue-500 outline-none transition-all text-sm');
        document.querySelectorAll('.label-std').forEach(el => el.className += ' block text-sm font-medium text-slate-700 mb-1');
        document.querySelectorAll('.btn-secondary').forEach(el => el.className += ' bg-slate-200 hover:bg-slate-300 text-slate-700 px-3 rounded-lg text-xs font-medium transition py-2');
        document.querySelectorAll('.btn-primary').forEach(el => el.className += ' text-white px-6 py-2 rounded-lg font-medium shadow-lg transition-all');
        document.querySelectorAll('.output-card').forEach(el => el.className += ' bg-slate-900 rounded-lg overflow-hidden border border-slate-700 flex flex-col h-64 shadow-lg');
        document.querySelectorAll('.output-header').forEach(el => el.className += ' px-4 py-2 flex justify-between items-center border-b border-slate-700 text-slate-400 text-xs font-mono uppercase tracking-wider');
        document.querySelectorAll('.output-area').forEach(el => el.className += ' w-full h-full bg-slate-900 p-4 font-mono text-xs focus:outline-none resize-none leading-relaxed');
        document.querySelectorAll('.copy-btn').forEach(el => el.className += ' text-xs bg-slate-700 hover:bg-blue-600 px-2 py-1 rounded text-white transition');
        document.querySelectorAll('.card-shortcut').forEach(el => el.className += ' p-6 rounded-xl cursor-pointer transition-all flex flex-col items-center justify-center text-center h-40');
        document.querySelectorAll('.view-title').forEach(el => el.className += ' text-2xl font-bold mb-6 flex items-center gap-2');

        // --- SVLAN MAP ---
        const SVLAN_MAP = {
            "3011": "-TT-1/1", "3012": "-TT-1/2", "3013": "-TT-1/3", "3014": "-TT-1/4", "3015": "-TT-1/5", 
            "3016": "-TT-1/6", "3017": "-TT-1/7", "3018": "-TT-1/8", "3019": "-TT-1/9", "3020": "-TT-1/10", 
            "3021": "-TT-1/11", "3022": "-TT-1/12", "3023": "-TT-1/13", "3024": "-TT-1/14", "3025": "-TT-1/15", 
            "3026": "-TT-1/16", "3031": "-TT-2/1", "3032": "-TT-2/2", "3033": "-TT-2/3", "3034": "-TT-2/4", 
            "3035": "-TT-2/5", "3036": "-TT-2/6", "3037": "-TT-2/7", "3038": "-TT-2/8", "3039": "-TT-2/9", 
            "3040": "-TT-2/10", "3041": "-TT-2/11", "3042": "-TT-2/12", "3043": "-TT-2/13", "3044": "-TT-2/14", 
            "3045": "-TT-2/15", "3046": "-TT-2/16", "3051": "-PND-1/1", "3052": "-PND-1/2", "3053": "-PND-1/3", 
            "3054": "-PND-1/4", "3055": "-PND-1/5", "3056": "-PND-1/6", "3057": "-PND-1/7", "3058": "-PND-1/8", 
            "3059": "-PND-1/9", "3060": "-PND-1/10", "3061": "-PND-1/11", "3062": "-PND-1/12", "3063": "-PND-1/13", 
            "3064": "-PND-1/14", "3065": "-PND-1/15", "3066": "-PND-1/16", "3071": "-PND-2/1", "3072": "-PND-2/2", 
            "3073": "-PND-2/3", "3074": "-PND-2/4", "3075": "-PND-2/5", "3076": "-PND-2/6", "3077": "-PND-2/7", 
            "3078": "-PND-2/8", "3079": "-PND-2/9", "3080": "-PND-2/10", "3081": "-PND-2/11", "3082": "-PND-2/12", 
            "3083": "-PND-2/13", "3084": "-PND-2/14", "3085": "-PND-2/15", "3086": "-PND-2/16", "3131": "-KSP-1/1", 
            "3132": "-KSP-1/2", "3133": "-KSP-1/3", "3134": "-KSP-1/4", "3135": "-KSP-1/5", "3136": "-KSP-1/6", 
            "3137": "-KSP-1/7", "3138": "-KSP-1/8", "3139": "-KSP-1/9", "3140": "-KSP-1/10", "3141": "-KSP-1/11", 
            "3142": "-KSP-1/12", "3143": "-KSP-1/13", "3144": "-KSP-1/14", "3145": "-KSP-1/15", "3146": "-KSP-1/16", 
            "3151": "-KSP-2/1", "3152": "-KSP-2/2", "3153": "-KSP-2/3", "3154": "-KSP-2/4", "3155": "-KSP-2/5", 
            "3156": "-KSP-2/6", "3157": "-KSP-2/7", "3158": "-KSP-2/8", "3159": "-KSP-2/9", "3160": "-KSP-2/10", 
            "3161": "-KSP-2/11", "3162": "-KSP-2/12", "3163": "-KSP-2/13", "3164": "-KSP-2/14", "3165": "-KSP-2/15", 
            "3166": "-KSP-2/16", "3171": "-SMB-1/1", "3172": "-SMB-1/2", "3173": "-SMB-1/3", "3174": "-SMB-1/4", 
            "3175": "-SMB-1/5", "3176": "-SMB-1/6", "3177": "-SMB-1/7", "3178": "-SMB-1/8", "3179": "-SMB-1/9", 
            "3180": "-SMB-1/10", "3181": "-SMB-1/11", "3182": "-SMB-1/12", "3183": "-SMB-1/13", "3184": "-SMB-1/14", 
            "3185": "-SMB-1/15", "3186": "-SMB-1/16", "3191": "-SMB-2/1", "3192": "-SMB-2/2", "3193": "-SMB-2/3", 
            "3194": "-SMB-2/4", "3195": "-SMB-2/5", "3196": "-SMB-2/6", "3197": "-SMB-2/7", "3198": "-SMB-2/8", 
            "3199": "-SMB-2/9", "3200": "-SMB-2/10", "3201": "-SMB-2/11", "3202": "-SMB-2/12", "3203": "-SMB-2/13", 
            "3204": "-SMB-2/14", "3205": "-SMB-2/15", "3206": "-SMB-2/16", "3211": "-SMT-1/1", "3212": "-SMT-1/2", 
            "3213": "-SMT-1/3", "3214": "-SMT-1/4", "3215": "-SMT-1/5", "3216": "-SMT-1/6", "3217": "-SMT-1/7", 
            "3218": "-SMT-1/8", "3219": "-SMT-1/9", "3220": "-SMT-1/10", "3221": "-SMT-1/11", "3222": "-SMT-1/12", 
            "3223": "-SMT-1/13", "3224": "-SMT-1/14", "3225": "-SMT-1/15", "3226": "-SMT-1/16", "3091": "-KRJT-1/1", 
            "3092": "-KRJT-1/2", "3093": "-KRJT-1/3", "3094": "-KRJT-1/4", "3095": "-KRJT-1/5", "3096": "-KRJT-1/6", 
            "3097": "-KRJT-1/7", "3098": "-KRJT-1/8", "3099": "-KRJT-1/9", "3100": "-KRJT-1/10", "3101": "-KRJT-1/11", 
            "3102": "-KRJT-1/12", "3103": "-KRJT-1/13", "3104": "-KRJT-1/14", "3105": "-KRJT-1/15", "3106": "-KRJT-1/16", 
            "4011": "-MALL-1/1", "4012": "-MALL-1/2", "4013": "-MALL-1/3", "4014": "-MALL-1/4", "4015": "-MALL-1/5", 
            "4031": "-APT-1/1", "4032": "-APT-1/2", "4033": "-APT-1/3", "4034": "-APT-1/4", "4035": "-APT-1/5", 
            "4036": "-APT-1/6", "4037": "-APT-1/7", "4038": "-APT-1/8", "4017": "-SRL-1/7"
        };

        // --- NAVIGATION ---
        const mobileBtn = document.getElementById('mobile-menu-btn');
        const sidebar = document.getElementById('main-sidebar');
        
        mobileBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            sidebar.classList.toggle('hidden');
            sidebar.classList.toggle('flex');
        });

        document.addEventListener('click', (e) => {
            if (window.innerWidth < 768) {
                if (!sidebar.contains(e.target) && !mobileBtn.contains(e.target)) {
                    sidebar.classList.add('hidden');
                    sidebar.classList.remove('flex');
                }
            }
        });

        function switchView(viewId) {
            document.querySelectorAll('.section-view').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.nav-btn').forEach(el => el.classList.remove('bg-slate-800', 'text-white', 'shadow-md'));
            document.querySelectorAll('.nav-btn').forEach(el => el.classList.add('text-slate-300'));
            
            const target = document.getElementById('view-' + viewId);
            if(target) target.classList.add('active');

            const btn = document.querySelector(`.nav-btn[data-target="${viewId}"]`);
            if(btn) {
                btn.classList.add('bg-slate-800', 'text-white', 'shadow-md');
                btn.classList.remove('text-slate-300');
            }
            if (window.innerWidth < 768) {
                sidebar.classList.add('hidden');
                sidebar.classList.remove('flex');
            }
        }

        // --- HELPER FUNCTIONS ---
        function generatePassword(targetId) {
            const chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
            let pass = "";
            for (let i = 0; i < 10; i++) pass += chars.charAt(Math.floor(Math.random() * chars.length));
            document.getElementById(targetId).value = pass;
        }

        function generateVlanName(svlanId, cvlanId, targetId) {
            const svlan = document.getElementById(svlanId).value.trim();
            const cvlanStr = document.getElementById(cvlanId).value.trim();
            if (!svlan || !cvlanStr) return alert('Isi SVLAN dan CVLAN dulu!');
            const mapping = SVLAN_MAP[svlan];
            if (!mapping) return alert('SVLAN tidak ditemukan!');
            const cvlanNum = parseInt(cvlanStr);
            document.getElementById(targetId).value = `vlan${cvlanNum}${mapping}:${cvlanNum - 10}`;
        }

        function copyToClipboard(elementId) {
            const el = document.getElementById(elementId);
            if(!el.value) return;
            navigator.clipboard.writeText(el.value).then(() => {
                const btn = document.querySelector(`button[onclick="copyToClipboard('${elementId}')"]`);
                const originalText = btn.innerText;
                btn.innerText = "OK!";
                btn.classList.add('bg-green-500');
                setTimeout(() => {
                    btn.innerText = originalText;
                    btn.classList.remove('bg-green-500');
                }, 1500);
            });
        }

		 function clearForm(prefix) {
			let viewId = '';
			
			// Logic mapping prefix ke ID View
			if (prefix === 'bs-pub') viewId = 'view-bs-ippub';
			else if (prefix === 'bs-priv') viewId = 'view-bs-ippriv';
			else if (prefix === 'term') viewId = 'view-terminate';
			else if (prefix === 'prime') viewId = 'view-prime-pppoe';
			else if (prefix === 'cs-prime') viewId = 'view-cs-prime'; // Tambahan Baru
			else if (prefix === 'cs-imp') viewId = 'view-cs-imp';     // Tambahan Baru
			else viewId = 'view-' + prefix + '-pppoe'; // Default pattern

			const container = document.getElementById(viewId);
			if(container) {
				container.querySelectorAll('input').forEach(i => i.value = '');
				container.querySelectorAll('textarea').forEach(t => t.value = '');
			}
		}

        function getNetworkAddress(ipCidr) {
            try {
                const [ip, prefixStr] = ipCidr.split('/');
                if(!ip || !prefixStr) return null;
                const prefix = parseInt(prefixStr);
                const ipParts = ip.split('.').map(Number);
                const mask = -1 << (32 - prefix);
                const ipInt = (ipParts[0] << 24) | (ipParts[1] << 16) | (ipParts[2] << 8) | ipParts[3];
                const netInt = ipInt & mask;
                return `${(netInt>>>24)&255}.${(netInt>>>16)&255}.${(netInt>>>8)&255}.${netInt&255}/${prefix}`;
            } catch(e) { return null; }
        }

        // --- WIREGUARD LOGIC ---
        function bytesToBase64(bytes) {
            let binary = '';
            for (let i = 0; i < bytes.length; i++) binary += String.fromCharCode(bytes[i]);
            return btoa(binary);
        }
        function clampPrivateKey(sk) {
            const clamped = new Uint8Array(sk);
            clamped[0] &= 248; clamped[31] &= 127; clamped[31] |= 64;
            return clamped;
        }
        function generateWgKeys(privId, pubId) {
            if (typeof nacl === 'undefined') return alert('Library belum load.');
            let raw = new Uint8Array(32);
            if (window.crypto && window.crypto.getRandomValues) window.crypto.getRandomValues(raw);
            else raw = nacl.randomBytes(32);
            const clamped = clampPrivateKey(raw);
            const pub = nacl.scalarMult.base(clamped);
            document.getElementById(privId).value = bytesToBase64(clamped);
            document.getElementById(pubId).value = bytesToBase64(pub);
        }

        // --- PROCESSING LOGIC ---
        
        function processPrimePPPoE() {
            const nama = document.getElementById('prm-nama').value;
            const sid = document.getElementById('prm-sid').value;
            const bw = document.getElementById('prm-bw').value;
            const ip = document.getElementById('prm-ip').value;
            const svlan = document.getElementById('prm-svlan').value;
            const cvlan = document.getElementById('prm-cvlan').value;
            const vname = document.getElementById('prm-vlan-name').value;
            if(!nama || !sid || !bw || !ip || !svlan) return alert('Data belum lengkap!');
            
            const limiter = `PRM-${bw} - ${sid} - ${nama.toUpperCase()}`;
            const burst = (parseInt(bw)*2)+"M";
            const bTress = (parseInt(bw)-1)+"M";
            const bwFmt = bw+"M";
            
            const s1 = `/interface vlan add vlan-id=${cvlan} name=${vname} comment="------- vlan - ${nama}" interface=vlan${svlan} mtu=8000
/interface pppoe-server server add service-name=PRM.Service interface=${vname} disabled=no mrru=1600 default-profile=Dedicated
/queue simple add burst-limit=${burst}/${burst} burst-threshold=${bTress}/${bTress} burst-time=20s/20s max-limit=${bwFmt}/${bwFmt} name="${limiter}" target=${ip}/32`;
            const s2 = `/interface vlan add vlan-id=${cvlan} name=DR2---${vname} comment="------- vlan - ${nama}" interface=DR2---vlan${svlan} mtu=8000
/interface pppoe-server server add service-name=PRM.Service interface=DR2---${vname} disabled=no mrru=1600 default-profile=Dedicated pado-delay=1000
/queue simple add burst-limit=${burst}/${burst} burst-threshold=${bTress}/${bTress} burst-time=20s/20s max-limit=${bwFmt}/${bwFmt} name="${limiter}" target=${ip}/32`;
            document.getElementById('out-prm-1').value = s1; document.getElementById('out-prm-2').value = s2;
        }

        function processPrimeStatik() {
             const nama = document.getElementById('prm-st-nama').value;
             const sid = document.getElementById('prm-st-sid').value;
             const bw = document.getElementById('prm-st-bw').value;
             const ip = document.getElementById('prm-st-ip').value;
             const svlan = document.getElementById('prm-st-svlan').value;
             const cvlan = document.getElementById('prm-st-cvlan').value;
             const vname = document.getElementById('prm-st-vlan-name').value;
             if(!nama || !ip || !svlan) return alert('Data belum lengkap');
             
             const targetNet = getNetworkAddress(ip);
             const limiter = `PRM-${bw} - ${sid} - ${nama.toUpperCase()}`;
             const burst = (parseInt(bw)*2)+"M";
             const bTress = (parseInt(bw)-1)+"M";
             const bwFmt = bw+"M";
             
             const s1 = `/interface vlan add vlan-id=${cvlan} name=${vname} comment="------- vlan - ${nama}" interface=vlan${svlan} mtu=8000
/ip address add address=${ip} interface=${vname} comment="IP Gateway ${nama}"
/queue simple add burst-limit=${burst}/${burst} burst-threshold=${bTress}/${bTress} burst-time=20s/20s max-limit=${bwFmt}/${bwFmt} name="${limiter}" target=${targetNet}`;
             const s2 = `/interface vlan add vlan-id=${cvlan} name=DR2---${vname} comment="------- vlan - ${nama}" interface=DR2---vlan${svlan} mtu=8000
/ip address add address=${ip} interface=DR2---${vname} comment="IP Gateway ${nama}" disabled=yes
/queue simple add burst-limit=${burst}/${burst} burst-threshold=${bTress}/${bTress} burst-time=20s/20s max-limit=${bwFmt}/${bwFmt} name="${limiter}" target=${targetNet}`;
             document.getElementById('out-prm-st-1').value = s1; document.getElementById('out-prm-st-2').value = s2;
        }

        function processImpressivePPPoE() {
            const nama = document.getElementById('imp-nama').value;
            const sid = document.getElementById('imp-sid').value;
            const bw = document.getElementById('imp-bw').value;
            const ip = document.getElementById('imp-ip').value;
            const svlan = document.getElementById('imp-svlan').value;
            const cvlan = document.getElementById('imp-cvlan').value;
            const vname = document.getElementById('imp-vlan-name').value;
            const parent = document.getElementById('imp-parent').value;
            if(!nama || !sid) return alert('Data belum lengkap');
            
            const limiter = `IMP-${bw} - ${sid} - ${nama.toUpperCase()}`;
            const limitAt = Math.floor(parseInt(bw)/2)+"M";
            
            const s1 = `/interface vlan add vlan-id=${cvlan} name=${vname} comment="------- vlan - ${nama}" interface=vlan${svlan} mtu=8000
/interface pppoe-server server add service-name=IMP.Service interface=${vname} disabled=no mrru=1600 default-profile=Maxi-Broadband
/queue simple add name="${limiter}" target=${ip}/32 max-limit=${bw}M/${bw}M parent="${parent}" priority=8/8 limit-at=${limitAt}/${limitAt}`;
            const s2 = `/interface vlan add vlan-id=${cvlan} name=DR1---${vname} comment="------- vlan - ${nama}" interface=DR1---vlan${svlan} mtu=8000
/interface pppoe-server server add service-name=IMP.Service interface=DR1---${vname} disabled=no mrru=1600 default-profile=Maxi-Broadband pado-delay=1000
/queue simple add name="${limiter}" target=${ip}/32 max-limit=${bw}M/${bw}M parent="${parent}" priority=8/8 limit-at=${limitAt}/${limitAt}`;
            document.getElementById('out-imp-1').value = s1; document.getElementById('out-imp-2').value = s2;
        }
        
        function processChangeService() {
            const nama = document.getElementById('cs-nama').value;
            const sid = document.getElementById('cs-sid').value;
            const bw = document.getElementById('cs-bw').value;
            const oldIp = document.getElementById('cs-ip-old').value;
            const newIp = document.getElementById('cs-ip-new').value;
            const parent = document.getElementById('cs-parent').value;
            if(!nama) return alert('Data kurang');
            
            const limiter = `IMP-${bw} - ${sid} - ${nama.toUpperCase()}`;
            const limitAt = Math.floor(parseInt(bw)/2)+"M";
            const s1 = `/queue simple remove [ find where target=${oldIp} ]
/queue simple add name="${limiter}" target=${newIp} max-limit=${bw}M/${bw}M parent="${parent}" priority=8/8 limit-at=${limitAt}/${limitAt}`;
            const s2 = `Ganti IP\nNama Klien = ${nama}\nIP Lama = ${oldIp}\nIP Baru = ${newIp}`;
            document.getElementById('out-cs-1').value = s1; document.getElementById('out-cs-2').value = s2;
        }

        // --- LOGIC BITSTREAM ---
        function processBsIpPub() {
            const nama = document.getElementById('bs-pub-nama').value;
            const sid = document.getElementById('bs-pub-sid').value;
            const bw = document.getElementById('bs-pub-bw').value;
            const priv = document.getElementById('bs-pub-priv').value;
            const pub = document.getElementById('bs-pub-pub').value;
            const ip = document.getElementById('bs-pub-ip').value;
            const parent = document.getElementById('bs-pub-parent').value;
            const wan = document.getElementById('bs-pub-wan').value;
            if(!nama || !ip) return alert('Data kurang');

            const limiter = `IMP-${bw} - ${sid} - ${nama.toUpperCase()}`;
            const limitAt = Math.floor(parseInt(bw)/2)+"M";
            
            const s1 = `/interface wireguard peers add name="[BS] ${nama}" interface=WG-BITSTREAM public-key="${pub}" allowed-address=${ip}/32 client-address=${ip}/32
/queue simple add name="${limiter}" target=${wan}/32 max-limit=${bw}M/${bw}M parent="${parent}" priority=8/8 limit-at=${limitAt}/${limitAt} comment="IP Publik ${ip}"
/ip address add address=103.17.244.4 network=${ip} interface=WG-BITSTREAM comment="IP Publik ${nama}"`;

            const s2 = `/ip dhcp-client add comment="[STD.NEXA] JANGAN DISABLE" default-route-distance=2 interface=ether1
/interface wireguard add name=Wireguard-Nexa private-key="${priv}"
/ip route add dst-address=116.254.117.228/30 gateway=192.168.1.1 comment="[STD.NEXA] Gateway WG Nexa"
/ip address add address=${ip} network=103.17.244.4 interface=Wireguard-Nexa comment="[STD.NEXA] IP Publik NEXA"
/interface wireguard peers add allowed-address=0.0.0.0/0 endpoint-address=116.254.117.230 endpoint-port=13231 interface=Wireguard-Nexa name=Peer-WG-Nexa public-key="N/LwVmgBrjtjuww/w2g1u71MtR2OL8LSrLLZaPFCjRk="
/ip route add dst-address=0.0.0.0/0 gateway=103.17.244.4 comment="[STD.NEXA] Mainroute WG" check-gateway=ping`;

            document.getElementById('out-bs-pub-1').value = s1;
            document.getElementById('out-bs-pub-2').value = s2;
        }

        function processBsIpPriv() {
            const nama = document.getElementById('bs-priv-nama').value;
            const sid = document.getElementById('bs-priv-sid').value;
            const bw = document.getElementById('bs-priv-bw').value;
            const priv = document.getElementById('bs-priv-priv').value;
            const pub = document.getElementById('bs-priv-pub').value;
            const ip = document.getElementById('bs-priv-ip').value;
            const parent = document.getElementById('bs-priv-parent').value;
            const wan = document.getElementById('bs-priv-wan').value;
            if(!nama || !ip) return alert('Data kurang');

            const limiter = `IMP-${bw} - ${sid} - ${nama.toUpperCase()}`;
            const limitAt = Math.floor(parseInt(bw)/2)+"M";
            
            const s1 = `/interface wireguard peers add name="[BS] ${nama}" interface=WG-BITSTREAM public-key="${pub}" allowed-address=${ip}/32 client-address=${ip}/32
/queue simple add name="${limiter}" target=${wan}/32 max-limit=${bw}M/${bw}M parent="${parent}" priority=8/8 limit-at=${limitAt}/${limitAt}`;

            const s2 = `/ip dhcp-client add comment="[STD.NEXA] JANGAN DISABLE" default-route-distance=1 interface=ether1
/interface wireguard add name=Wireguard-Nexa private-key="${priv}"
/ip address add address=${ip}/24 interface=Wireguard-Nexa comment="[STD.NEXA] IP Monitoring NEXA"
/interface wireguard peers add allowed-address=0.0.0.0/0 endpoint-address=116.254.117.230 endpoint-port=13231 interface=Wireguard-Nexa name=Peer-WG-Nexa public-key="N/LwVmgBrjtjuww/w2g1u71MtR2OL8LSrLLZaPFCjRk="
/ip route add dst-address=111.68.27.8/30 gateway=10.251.86.1 comment="[STD.NEXA] Route Monitoring NEXA" check-gateway=ping
/ip route add dst-address=116.254.113.4/30 gateway=10.251.86.1 comment="[STD.NEXA] Route Monitoring NEXA" check-gateway=ping`;

            document.getElementById('out-bs-priv-1').value = s1;
            document.getElementById('out-bs-priv-2').value = s2;
        }

        // --- LOGIC TERMINATE ---
        function processTerminate() {
            const nama = document.getElementById('term-nama').value;
            const ip = document.getElementById('term-ip').value;
            if(!nama || !ip) return alert('Data kurang');

            document.getElementById('out-term-1').value = `/interface vlan remove [find where name="${nama}"]\n/queue simple remove [find where target="${ip}"]`;
            document.getElementById('out-term-2').value = `/interface vlan remove [find where name="DR1---${nama}"]\n/queue simple remove [find where target="${ip}"]`;
            document.getElementById('out-term-3').value = `/interface vlan remove [find where name="DR2---${nama}"]\n/queue simple remove [find where target="${ip}"]`;
        }
// --- LOGIC MAINTENANCE (YANG HILANG) ---

        function processCsPrime() {
            // 1. Ambil Data dari Form
            const nama = document.getElementById('cs-prm-nama').value;
            const sid = document.getElementById('cs-prm-sid').value;
            const bw = document.getElementById('cs-prm-bw').value;
            const ip = document.getElementById('cs-prm-ip').value;

            // 2. Validasi input tidak boleh kosong
            if(!nama || !sid || !bw || !ip) return alert('Data belum lengkap bosku!');

            // 3. Buat Format Nama Queue Baru
            const limiter = `PRM-${bw} - ${sid} - ${nama.toUpperCase()}`;
            
            // Hitung Burst (Rule: Max Limit * 2) & Threshold (Max Limit - 1)
            const burst = (parseInt(bw) * 2) + "M";
            const bTress = (parseInt(bw) - 1) + "M";
            const bwFmt = bw + "M";

            // 4. Generate Script Mikrotik (Update Queue yang sudah ada berdasarkan Target IP)
            // Asumsi input IP user belum ada /32, kita tambahkan agar spesifik
            let targetIp = ip.includes('/') ? ip : ip + "/32";

            const script = `/queue simple set [find target="${targetIp}"] name="${limiter}" max-limit=${bwFmt}/${bwFmt} burst-limit=${burst}/${burst} burst-threshold=${bTress}/${bTress} burst-time=20s/20s`;

            // 5. Tampilkan ke Textarea Output
            document.getElementById('out-cs-prm').value = script;
        }

        function processCsImp() {
            // 1. Ambil Data
            const nama = document.getElementById('cs-imp-nama').value;
            const sid = document.getElementById('cs-imp-sid').value;
            const bw = document.getElementById('cs-imp-bw').value;
            const oldIp = document.getElementById('cs-imp-old').value;
            const newIp = document.getElementById('cs-imp-new').value;
            const parent = document.getElementById('cs-imp-parent').value;

            if(!nama || !bw || !newIp || !parent) return alert('Data belum lengkap bosku!');

            // 2. Format Nama Baru
            const limiter = `IMP-${bw} - ${sid} - ${nama.toUpperCase()}`;
            const limitAt = Math.floor(parseInt(bw)/2) + "M";
            
            // 3. Generate Script (Hapus Queue Lama (jika ada IP lama) -> Buat Queue Baru)
            let script = "";
            
            // Jika user isi IP lama, buat script remove dulu
            if(oldIp) {
                let oldTarget = oldIp.includes('/') ? oldIp : oldIp + "/32";
                script += `/queue simple remove [find target="${oldTarget}"]\n`;
            }

            // Script create baru
            let newTarget = newIp.includes('/') ? newIp : newIp + "/32";
            script += `/queue simple add name="${limiter}" target="${newTarget}" max-limit=${bw}M/${bw}M parent="${parent}" priority=8/8 limit-at=${limitAt}/${limitAt}`;

            // 4. Buat Summary untuk Laporan
            const summary = `UPDATE LAYANAN IMPRESSIVE\n---------------------------\nKlien    : ${nama}\nServiceID: ${sid}\nPaket Baru: ${bw} Mbps\nIP Address: ${newIp}`;

            // 5. Output
            document.getElementById('out-cs-imp-1').value = script;
            document.getElementById('out-cs-imp-2').value = summary;
        }
		
        // Init
        switchView('dashboard');
    </script>
</body>
</html>
